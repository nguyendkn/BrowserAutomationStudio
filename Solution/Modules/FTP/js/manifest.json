{
    "actions": [
        {
            "code": [
                {
                    "file": "FTP_Config_code.js",
                    "name": "FTP_Config_code"
                }
            ],
            "description": {
                "en": "Configure FTP/SSH",
                "ru": "Настроить FTP/SSH"
            },
            "interface": "FTP_Config_interface.js",
            "is_element": false,
            "name": "FTP_Config",
            "select": "FTP_Config_select.js",
            "template": "{{Host}}"
        },
        {
            "code": [
                {
                    "file": "FTP_CheckExist_code.js",
                    "name": "FTP_CheckExist_code"
                }
            ],
            "description": {
                "en": "Check file/folder exists",
                "ru": "Проверить существование файла/папки"
            },
            "interface": "FTP_CheckExist_interface.js",
            "is_element": false,
            "name": "FTP_CheckExist",
            "select": "FTP_CheckExist_select.js",
            "template": "{{FilePath}} -> {{Save}}"
        },
		{
            "code": [
                {
                    "file": "FTP_GetInfo_code.js",
                    "name": "FTP_GetInfo_code"
                }
            ],
            "description": {
                "en": "File/Folder info",
                "ru": "Информация о файле/папке"
            },
            "interface": "FTP_GetInfo_interface.js",
            "is_element": false,
            "name": "FTP_GetInfo",
            "select": "FTP_GetInfo_select.js",
            "template": "{{FilePath}}"
        },
        {
            "code": [
                {
                    "file": "FTP_Delete_code.js",
                    "name": "FTP_Delete_code"
                }
            ],
            "description": {
                "en": "Delete file/folder",
                "ru": "Удалить файл/папку"
            },
            "interface": "FTP_Delete_interface.js",
            "is_element": false,
            "name": "FTP_Delete",
            "select": "FTP_Delete_select.js",
            "template": "{{FilePath}}"
        },
        {
            "code": [
                {
                    "file": "FTP_Move_code.js",
                    "name": "FTP_Move_code"
                }
            ],
            "description": {
                "en": "Move file/folder",
                "ru": "Переместить Файл/папку"
            },
            "interface": "FTP_Move_interface.js",
            "is_element": false,
            "name": "FTP_Move",
            "select": "FTP_Move_select.js",
            "template": "{{FilePath}} -> {{NewFilePath}}"
        },
		{
            "code": [
                {
                    "file": "FTP_Download_code.js",
                    "name": "FTP_Download_code"
                }
            ],
            "description": {
                "en": "Download file/folder",
                "ru": "Скачать файл/папку"
            },
            "interface": "FTP_Download_interface.js",
            "is_element": false,
            "name": "FTP_Download",
            "select": "FTP_Download_select.js",
            "template": "{{FilePath}} -> {{DestinationPath}}"
        },
		{
            "code": [
                {
                    "file": "FTP_Upload_code.js",
                    "name": "FTP_Upload_code"
                }
            ],
            "description": {
                "en": "Upload file/folder",
                "ru": "Загрузить файл/папку"
            },
            "interface": "FTP_Upload_interface.js",
            "is_element": false,
            "name": "FTP_Upload",
            "select": "FTP_Upload_select.js",
            "template": "{{FilePath}} -> {{DestinationPath}}"
        }
    ],
    "api_version": 1,
    "autogenerated_functions": [
        "FTP_Config",
        "FTP_CheckExist",
        "FTP_GetInfo",
        "FTP_Move",
        "FTP_Delete",
        "FTP_Download",
        "FTP_Upload"
    ],
    "browser": [
    ],
    "depends": [
    ],
    "description": "Working with remote servers",
    "description_small": {
        "en": "FTP/SSH",
        "ru": "FTP/SSH"
    },
    "developer_email": "sasha9817@mail.ru",
    "developer_name": "GhostZ",
    "developer_site": "https://t.me/GhostZed",
	"embeddeddata": [
        {
            "Data": "const Client = require('ftp');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nvar file_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar destination_directory = [[FTP_NODE_PARAMETERS]][1];\r\nvar config = [[FTP_NODE_PARAMETERS]][2];\r\nvar file_name = path.basename(file_path);\r\nvar file_directory = path.dirname(file_path);\r\nvar destination_path = destination_directory + \"/\" + file_name;\r\nconfig[\"user\"] = config[\"username\"];\r\ndelete config[\"username\"];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tclient.connect(config);\r\n    client.on('ready', function(){\r\n        fs.stat(file_path, function(err, stats) {\r\n            if(err){\r\n                client.end();\r\n                reject(err);\r\n            }else{\r\n                if(stats.isDirectory()){\r\n                    walk(file_path, function(err, files) {\r\n                        if(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        }else{\r\n                            files.unshift(file_path);\r\n                            var length = files.length;\r\n                            var count = 0;\r\n                            function counter(){\r\n                                count++;\r\n                                if(count==length){\r\n                                    client.end();\r\n                                };\r\n                            };\r\n                            files.forEach(function(file){\r\n                                var destination_path = destination_directory + \"/\" + file.replace(file_directory, \"\");\r\n                                fs.stat(file, function(err, stats){\r\n                                    if(err){\r\n                                        client.end();\r\n                                        reject(err);\r\n                                    }else{\r\n                                        var isDirectory = stats.isDirectory();\r\n                                        if(isDirectory){\r\n                                            client.mkdir(formatPath(destination_path), true, function(err){\r\n                                                if(err){\r\n                                                    client.end();\r\n                                                    reject(err);\r\n                                                }else{\r\n                                                    counter();\r\n                                                };\r\n                                            });\r\n                                        }else{\r\n                                            var destination_directory = path.dirname(destination_path);\r\n                                            client.mkdir(destination_directory, true, function(err){\r\n                                                if(err){\r\n                                                    client.end();\r\n                                                    reject(err);\r\n                                                }else{\r\n                                                    client.put(file, destination_path, function(err){\r\n                                                        if(err){\r\n                                                            client.end();\r\n                                                            reject(err);\r\n                                                        }else{\r\n                                                            counter();\r\n                                                        };\r\n                                                    });\r\n                                                };\r\n                                            });\r\n                                        };\r\n                                    };\r\n                                });\r\n                            });\r\n                        };\r\n                    });\r\n                }else{\r\n                    client.mkdir(destination_directory, true, function(err){\r\n                        if(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        }else{\r\n                            client.put(file_path, destination_path, function(err){\r\n                                if(err){\r\n                                    client.end();\r\n                                    reject(err);\r\n                                }else{\r\n                                    client.end();\r\n                                };\r\n                            });\r\n                        };\r\n                    });\r\n                };\r\n            };\r\n        });\r\n    });\r\n    client.on('error', function(err){\r\n        reject(err);\r\n    });\r\n    client.on('close', function close(){\r\n        resolve();\r\n    });\r\n}));\r\n\r\nfunction walk(dir, done) {\r\n    var results = [];\r\n    fs.readdir(dir, function(err, list){\r\n        if(err){return done(err)};\r\n        var pending = list.length;\r\n        if(!pending){return done(null, results)};\r\n        list.forEach(function(file){\r\n            file = path.resolve(dir, file);\r\n            results.push(formatPath(file));\r\n            fs.stat(file, function(err, stats) {\r\n                if(err){return done(err)};\r\n                if(stats && stats.isDirectory()){\r\n                    walk(file, function(err, res) {\r\n                        if(err){return done(err)};\r\n                        results = results.concat(res);\r\n                        if(!--pending){done(null, results)};\r\n                    });\r\n                }else{\r\n                    if(!--pending){done(null, results)};\r\n                };\r\n            });\r\n        });\r\n    });\r\n};\r\n\r\nfunction formatPath(path){\r\n\treturn path.split(\"\\\\\").join(\"/\");\r\n};",
            "DataName": "UploadFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ssh2-sftp-client');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar destination_directory = [[FTP_NODE_PARAMETERS]][1];\r\nvar config = [[FTP_NODE_PARAMETERS]][2];\r\nvar remote_name = path.basename(remote_path);\r\nvar remote_directory = path.dirname(remote_path);\r\nvar destination_path = path.join(destination_directory, remote_name);\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tvar connect = client.connect(config);\r\n    connect.then(function(){\r\n        var exists = client.exists(remote_path);\r\n        exists.then(function(exist){\r\n            if(exist){\r\n                var stat = client.stat(remote_path);\r\n                stat.then(function(stats){\r\n                    var isDirectory = stats.isDirectory;\r\n                    if(isDirectory){\r\n                        ensureDirectoryExistence(path.join(destination_path, \"test.txt\"));\r\n                        var downloadDir = client.downloadDir(remote_path, destination_path);\r\n                        downloadDir.then(function(){\r\n                            client.end();\r\n                            resolve();\r\n                        });\r\n                        downloadDir.catch(function(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        });\r\n                    }else{\r\n                        ensureDirectoryExistence(destination_path);\r\n                        var fastGet = client.fastGet(remote_path, destination_path);\r\n                        fastGet.then(function(){\r\n                            client.end();\r\n                            resolve();\r\n                        });\r\n                        fastGet.catch(function(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        });\r\n                    };\r\n                });\r\n                stat.catch(function(err){\r\n                    client.end();\r\n                    reject(err);\r\n                });\r\n            }else{\r\n                client.end();\r\n                reject('The file/folder \"' + remote_path + '\" does not exist');\r\n            };\r\n        });\r\n        exists.catch(function(err){\r\n            client.end();\r\n            reject(err);\r\n        });\r\n    });\r\n    connect.catch(function(err){\r\n        client.end();\r\n        reject(err);\r\n    });\r\n}));\r\n\r\nfunction ensureDirectoryExistence(filePath){\r\n    var dirname = path.dirname(filePath);\r\n    if(fs.existsSync(dirname)){\r\n        return true;\r\n    };\r\n    ensureDirectoryExistence(dirname);\r\n    fs.mkdirSync(dirname);\r\n};",
            "DataName": "DownloadSFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ssh2-sftp-client');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nvar file_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar destination_directory = [[FTP_NODE_PARAMETERS]][1];\r\nvar config = [[FTP_NODE_PARAMETERS]][2];\r\nvar file_name = path.basename(file_path);\r\nvar destination_path = destination_directory + \"/\" + file_name;\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tvar connect = client.connect(config);\r\n    connect.then(function(){\r\n        fs.stat(file_path, function(err, stats){\r\n            if(err){\r\n                client.end();\r\n                reject(err);\r\n            }else{\r\n                if(stats.isDirectory()){\r\n                    ensureDirectoryExistence(destination_path, function(err){\r\n                        if(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        }else{\r\n                            var uploadDir = client.uploadDir(file_path, destination_path);\r\n                            uploadDir.then(function(){\r\n                                client.end();\r\n                                resolve();\r\n                            });\r\n                            uploadDir.catch(function(err){\r\n                                client.end();\r\n                                reject(err);\r\n                            });\r\n                        };\r\n                    })\r\n                }else{\r\n                    ensureDirectoryExistence(destination_path, function(err){\r\n                        if(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        }else{\r\n                            var fastPut = client.fastPut(file_path, destination_path);\r\n                            fastPut.then(function(){\r\n                                client.end();\r\n                                resolve();\r\n                            });\r\n                            fastPut.catch(function(err){\r\n                                client.end();\r\n                                reject(err);\r\n                            });\r\n                        };\r\n                    })\r\n                };\r\n            };\r\n        });\r\n    });\r\n    connect.catch(function(err){\r\n        client.end();\r\n        reject(err);\r\n    });\r\n\r\n    function ensureDirectoryExistence(filePath, done){\r\n        var dirname = path.dirname(filePath);\r\n        var exists = client.exists(dirname);\r\n        exists.then(function(exist){\r\n            if(exist){\r\n                done(null);\r\n            }else{\r\n                var mkdir = client.mkdir(dirname, true);\r\n                mkdir.then(function(){\r\n                    done(null);\r\n                });\r\n                mkdir.catch(function(err){\r\n                    done(err);\r\n                });\r\n            };\r\n        });\r\n        exists.catch(function(err){\r\n            done(err);\r\n        });\r\n    };\r\n}));",
            "DataName": "UploadSFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ssh2-sftp-client');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar config = [[FTP_NODE_PARAMETERS]][1];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tvar connect = client.connect(config);\r\n    connect.then(function(){\r\n        var exists = client.exists(remote_path);\r\n        exists.then(function(exist){\r\n            if(exist){\r\n                var stat = client.stat(remote_path);\r\n                stat.then(function(stats){\r\n                    var isDirectory = stats.isDirectory;\r\n                    if(isDirectory){\r\n                        var rmdir = client.rmdir(remote_path, true);\r\n                        rmdir.then(function(){\r\n                            client.end();\r\n                            resolve();\r\n                        });\r\n                        rmdir.catch(function(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        });\r\n                    }else{\r\n                        var deletef = client.delete(remote_path);\r\n                        deletef.then(function(){\r\n                            client.end();\r\n                            resolve();\r\n                        });\r\n                        deletef.catch(function(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        });\r\n                    };\r\n                });\r\n                stat.catch(function(err){\r\n                    client.end();\r\n                    reject(err);\r\n                });\r\n            }else{\r\n                client.end();\r\n                reject('The file/folder \"' + remote_path + '\" does not exist');\r\n            };\r\n        });\r\n        exists.catch(function(err){\r\n            client.end();\r\n            reject(err);\r\n        });\r\n    });\r\n    connect.catch(function(err){\r\n        client.end();\r\n        reject(err);\r\n    });\r\n}));",
            "DataName": "DeleteSFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ftp');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar config = [[FTP_NODE_PARAMETERS]][1];\r\nvar remote_name = path.basename(remote_path);\r\nvar remote_directory = path.dirname(remote_path);\r\nconfig[\"user\"] = config[\"username\"];\r\ndelete config[\"username\"];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tclient.connect(config);\r\n    client.on('ready', function(){\r\n        client.list(remote_directory, function(err, list){\r\n            if(err){\r\n                client.end();\r\n                reject(err);\r\n            }else{\r\n                var list = list.filter(function(file){return decodeURIComponent(escape(file[\"name\"]))==remote_name});\r\n                if(list.length > 0){\r\n                    if(list[0][\"type\"]==\"d\"){\r\n                        client.rmdir(remote_path, true, function(err) {\r\n                            if(err){\r\n                                client.end();\r\n                                reject(err);\r\n                            }else{\r\n                                client.end();\r\n                            };\r\n                        });\r\n                    }else{\r\n                        client.delete(remote_path, function(err) {\r\n                            if(err){\r\n                                client.end();\r\n                                reject(err);\r\n                            }else{\r\n                                client.end();\r\n                            };\r\n                        });\r\n                    };\r\n                }else{\r\n                    client.end();\r\n                    reject('The file/folder \"' + remote_path + '\" does not exist');\r\n                };\r\n            };\r\n        });\r\n    });\r\n    client.on('error', function(err){\r\n        reject(err);\r\n    });\r\n    client.on('close', function close(){\r\n        resolve();\r\n    });\r\n}));",
            "DataName": "DeleteFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ssh2-sftp-client');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar new_remote_path = [[FTP_NODE_PARAMETERS]][1];\r\nvar config = [[FTP_NODE_PARAMETERS]][2];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tvar connect = client.connect(config);\r\n    connect.then(function(){\r\n        var exists = client.exists(remote_path);\r\n        exists.then(function(exist){\r\n            if(exist){\r\n                ensureDirectoryExistence(new_remote_path, function(err){\r\n                    if(err){\r\n                        client.end();\r\n                        reject(err);\r\n                    }else{\r\n                        var rename = client.rename(remote_path, new_remote_path);\r\n                        rename.then(function(){\r\n                            client.end();\r\n                            resolve();\r\n                        });\r\n                        rename.catch(function(err){\r\n                            client.end();\r\n                            reject(err);\r\n                        });\r\n                    };\r\n                })\r\n            }else{\r\n                client.end();\r\n                reject('The file \"' + remote_path + '\" does not exist');\r\n            };\r\n        });\r\n        exists.catch(function(err){\r\n            client.end();\r\n            reject(err);\r\n        });\r\n    });\r\n    connect.catch(function(err){\r\n        client.end();\r\n        reject(err);\r\n    });\r\n\r\n    function ensureDirectoryExistence(filePath, done){\r\n        var dirname = path.dirname(filePath);\r\n        var exists = client.exists(dirname);\r\n        exists.then(function(exist){\r\n            if(exist){\r\n                done(null);\r\n            }else{\r\n                var mkdir = client.mkdir(dirname, true);\r\n                mkdir.then(function(){\r\n                    done(null);\r\n                });\r\n                mkdir.catch(function(err){\r\n                    done(err);\r\n                });\r\n            };\r\n        });\r\n        exists.catch(function(err){\r\n            done(err);\r\n        });\r\n    };\r\n}));",
            "DataName": "MoveSFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ftp');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar new_remote_path = [[FTP_NODE_PARAMETERS]][1];\r\nvar config = [[FTP_NODE_PARAMETERS]][2];\r\nvar new_remote_directory = path.dirname(new_remote_path);\r\nconfig[\"user\"] = config[\"username\"];\r\ndelete config[\"username\"];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tclient.connect(config);\r\n    client.on('ready', function(){\r\n        client.mkdir(new_remote_directory, true, function(err){\r\n            if(err){\r\n                client.end();\r\n                reject(err);\r\n            }else{\r\n                client.rename(remote_path, new_remote_path, function(err){\r\n                    if(err){\r\n                        client.end();\r\n                        reject(err);\r\n                    }else{\r\n                        client.end();\r\n                    };\r\n                });\r\n            };\r\n        });\r\n    });\r\n    client.on('error', function(err){\r\n        reject(err);\r\n    });\r\n    client.on('close', function close(){\r\n        resolve();\r\n    });\r\n}));",
            "DataName": "MoveFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ssh2-sftp-client');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar config = [[FTP_NODE_PARAMETERS]][1];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tvar connect = client.connect(config);\r\n    connect.then(function(){\r\n        var exists = client.exists(remote_path);\r\n        exists.then(function(exist){\r\n            if(exist){\r\n                [[FTP_NODE_PARAMETERS]] = true;\r\n            }else{\r\n                [[FTP_NODE_PARAMETERS]] = false;\r\n            };\r\n            client.end();\r\n            resolve();\r\n        });\r\n        exists.catch(function(err){\r\n            client.end();\r\n            reject(err);\r\n        });\r\n    });\r\n    connect.catch(function(err){\r\n        client.end();\r\n        reject(err);\r\n    });\r\n}));",
            "DataName": "CheckExistSFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ftp');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar config = [[FTP_NODE_PARAMETERS]][1];\r\nvar remote_name = path.basename(remote_path);\r\nvar remote_directory = path.dirname(remote_path);\r\nconfig[\"user\"] = config[\"username\"];\r\ndelete config[\"username\"];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tclient.connect(config);\r\n    client.on('ready', function(){\r\n        client.list(remote_directory, function(err, list){\r\n            if(err){\r\n                if(err.message.indexOf(\"No such file or directory\") > -1){\r\n                    [[FTP_NODE_PARAMETERS]] = false;\r\n                    client.end();\r\n                }else{\r\n                    client.end();\r\n                    reject(err);\r\n                };\r\n            }else{\r\n                if(list.filter(function(file){return decodeURIComponent(escape(file[\"name\"]))==remote_name}).length > 0){\r\n                    [[FTP_NODE_PARAMETERS]] = true;\r\n                }else{\r\n                    [[FTP_NODE_PARAMETERS]] = false;\r\n                };\r\n                client.end();\r\n            };\r\n        });\r\n    });\r\n    client.on('error', function(err){\r\n        reject(err);\r\n    });\r\n    client.on('close', function close(){\r\n        resolve();\r\n    });\r\n}));",
            "DataName": "CheckExistFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ssh2-sftp-client');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar config = [[FTP_NODE_PARAMETERS]][1];\r\nvar remote_directory = path.dirname(remote_path);\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tvar connect = client.connect(config);\r\n    connect.then(function(){\r\n        var exists = client.exists(remote_path);\r\n        exists.then(function(exist){\r\n            if(exist){\r\n                var stat = client.stat(remote_path);\r\n                stat.then(function(stats){\r\n                    [[FTP_NODE_PARAMETERS]] = {directory: remote_directory, exists: true, is_directory: stats.isDirectory, is_file: stats.isFile, last_modified: stats.modifyTime, size: stats.size};\r\n                    client.end();\r\n                    resolve();\r\n                });\r\n                stat.catch(function(err){\r\n                    client.end();\r\n                    reject(err);\r\n                });\r\n            }else{\r\n                [[FTP_NODE_PARAMETERS]] = {directory: \"\", exists: false, is_directory: false, is_file: false, last_modified: 0, size: 0};\r\n                client.end();\r\n                resolve();\r\n            };\r\n        });\r\n        exists.catch(function(err){\r\n            client.end();\r\n            reject(err);\r\n        });\r\n    });\r\n    connect.catch(function(err){\r\n        client.end();\r\n        reject(err);\r\n    });\r\n}));",
            "DataName": "GetInfoSFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ftp');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar config = [[FTP_NODE_PARAMETERS]][1];\r\nvar remote_name = path.basename(remote_path);\r\nvar remote_directory = path.dirname(remote_path);\r\nconfig[\"user\"] = config[\"username\"];\r\ndelete config[\"username\"];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tclient.connect(config);\r\n    client.on('ready', function(){\r\n        client.list(remote_directory, function(err, list){\r\n            if(err){\r\n                if(err.message.indexOf(\"No such file or directory\") > -1){\r\n                    [[FTP_NODE_PARAMETERS]] = {directory: \"\", exists: false, is_directory: false, is_file: false, last_modified: 0, size: 0};\r\n                    client.end();\r\n                }else{\r\n                    client.end();\r\n                    reject(err);\r\n                };\r\n            }else{\r\n                var list = list.filter(function(file){return decodeURIComponent(escape(file[\"name\"]))==remote_name});\r\n                if(list.length > 0){\r\n                    var file = list[0];\r\n                    var type = file[\"type\"];\r\n                    var last_modified = new Date(file[\"date\"]).getTime();\r\n                    var size = file[\"size\"];\r\n                    [[FTP_NODE_PARAMETERS]] = {directory: remote_directory, exists: true, is_directory: (type==\"d\" ? true : false), is_file: (type==\"-\" ? true : false), last_modified: last_modified, size: size};\r\n                }else{\r\n                    [[FTP_NODE_PARAMETERS]] = {directory: \"\", exists: false, is_directory: false, is_file: false, last_modified: 0, size: 0};\r\n                };\r\n                client.end();\r\n            };\r\n        });\r\n    });\r\n    client.on('error', function(err){\r\n        reject(err);\r\n    });\r\n    client.on('close', function close(){\r\n        resolve();\r\n    });\r\n}));",
            "DataName": "GetInfoFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        },
        {
            "Data": "const Client = require('ftp');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nvar remote_path = [[FTP_NODE_PARAMETERS]][0];\r\nvar destination_directory = [[FTP_NODE_PARAMETERS]][1];\r\nvar config = [[FTP_NODE_PARAMETERS]][2];\r\nvar remote_name = path.basename(remote_path);\r\nvar remote_directory = path.dirname(remote_path);\r\nconfig[\"user\"] = config[\"username\"];\r\ndelete config[\"username\"];\r\n\r\nawait (new Promise((resolve, reject) => {\r\n    var client = new Client();\r\n\tclient.connect(config);\r\n    client.on('ready', function(){\r\n        client.list(remote_directory, function(err, list){\r\n            if(err){\r\n                client.end();\r\n                reject(err);\r\n            }else{\r\n                var list = list.filter(function(file){return decodeName(file[\"name\"])==remote_name});\r\n                if(list.length > 0){\r\n                    var file = list[0];\r\n                    var fileName = decodeName(file[\"name\"]);\r\n                    var fileType = file[\"type\"];\r\n                    var destination_path = path.join(destination_directory, fileName);\r\n                    if(fileType==\"d\"){\r\n                        downloadFolder(remote_path, destination_path, function(err){\r\n                            if(err){\r\n                                client.end();\r\n                                reject(err);\r\n                            }else{\r\n                                client.end();\r\n                            };\r\n                        });\r\n                    }else{\r\n                        client.get(remote_path, function(err, stream) {\r\n                            if(err){\r\n                                reject(err);\r\n                            }else{\r\n                                ensureDirectoryExistence(destination_path);\r\n                                var writeStream = stream.pipe(fs.createWriteStream(destination_path));\r\n                                writeStream.on('error', function(err){\r\n                                    client.end();\r\n                                    reject(err);\r\n                                });\r\n                                writeStream.on('close', function close(){\r\n                                    client.end();\r\n                                });\r\n                            };\r\n                        });\r\n                    };\r\n                }else{\r\n                    client.end();\r\n                    reject('The file/folder \"' + remote_path + '\" does not exist');\r\n                };\r\n            };\r\n        });\r\n    });\r\n    client.on('error', function(err){\r\n        reject(err);\r\n    });\r\n    client.on('close', function close(){\r\n        resolve();\r\n    });\r\n\r\n    function downloadFolder(remote, destination, done){\r\n        ensureDirectoryExistence(path.join(destination, \"test.txt\"));\r\n        client.list(remote, function(err, list){\r\n            if(err){\r\n                done(err);\r\n            }else{\r\n                var list = list.filter(function(file){return [\".\",\"..\"].indexOf(file[\"name\"]) < 0});\r\n                var length = list.length;\r\n                var count = 0;\r\n                function counter(){\r\n                    count++;\r\n                    if(count==length){\r\n                        done(null);\r\n                    };\r\n                };\r\n                list.forEach(function(file){\r\n                    var fileName = decodeName(file[\"name\"]);\r\n                    var fileType = file[\"type\"];\r\n                    var remoteFullPath = remote + \"/\" + fileName;\r\n                    var destination_path = path.join(destination, fileName);\r\n                    if(fileType==\"d\"){\r\n                        downloadFolder(remoteFullPath, destination_path, function(err){\r\n                            if(err){\r\n                                done(err);\r\n                            }else{\r\n                                counter();\r\n                            };\r\n                        });\r\n                    }else{\r\n                        client.get(remoteFullPath, function(err, stream){\r\n                            if(err){\r\n                                done(err);\r\n                            }else{\r\n                                var writeStream = stream.pipe(fs.createWriteStream(destination_path));\r\n                                writeStream.on('error', function(err){\r\n                                    done(err);\r\n                                });\r\n                                writeStream.on('close', function close(){\r\n                                    counter();\r\n                                });\r\n                            };\r\n                        });\r\n                    };\r\n                });\r\n            };\r\n        });\r\n    };\r\n}));\r\n\r\nfunction decodeName(name) {\r\n    return decodeURIComponent(escape(name))\r\n};\r\n\r\nfunction ensureDirectoryExistence(filePath) {\r\n    var dirname = path.dirname(filePath);\r\n    if(fs.existsSync(dirname)){\r\n        return true;\r\n    };\r\n    ensureDirectoryExistence(dirname);\r\n    fs.mkdirSync(dirname);\r\n};",
            "DataName": "DownloadFTP",
            "DataType": 0,
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0"
        }
    ],
    "engine": [
        "engine.js"
    ],
    "icon": "FTP.png",
    "info": {
        "en": "Module for working with remote servers via FTP, SFTP, SSH protocols.",
        "ru": "Модуль для работы с удаленными серверами посредством FTP, SFTP, SSH протоколов."
    },
    "is_autogenerated": true,
    "languages": [
        {
            "Name": "Node",
            "Version": "8.6.0"
        }
    ],
    "localize": {
		"Port": {"ru":"Порт"},
		"is empty": {"ru":"пуст"},
		"Username": {"ru":"Логин"},
		"Password": {"ru":"Пароль"},
		"Protocol": {"ru":"Протокол"},
		"Host name": {"ru":"Имя хоста"},
		"Is file": {"ru":"Является файлом"},
		"Is directory": {"ru":"Является папкой"},
		"Is not file": {"ru":"Не является файлом"},
		"Can be blank": {"ru":"Может быть пустым"},
		"Destination path": {"ru":"Путь назначения"},
		"File/Folder size": {"ru":"Размер файла/папки"},
		"Is not directory": {"ru":"Не является папкой"},
		"File/Folder exists.": {"ru":"Файл/Папка существует."},
		"File or folder path": {"ru":"Путь к файлу или папке"},
		"Last modified date": {"ru":"Дата последнего изменения"},
		"File/Folder directory": {"ru":"Директория файла/папки"},
		"Variable not specified": {"ru":"Переменная не указаны"},
		"Variables not specified": {"ru":"Переменные не указаны"},
		"File/Folder existence": {"ru":"Существование файла/папки"},
		"Remote destination path": {"ru":"Удаленный путь назначения"},
		"Port of the remote server.": {"ru":"Порт удаленного сервера."},
		"File/Folder does not exist.": {"ru":"Файл/Папка не существует."},
		"Password of the remote server.": {"ru":"Пароль удаленного сервера."},
		"Remote path to file or folder": {"ru":"Удаленный путь к файлу или папке"},
		"Default port for FTP protocol": {"ru":"Порт по умолчанию для FTP протокола"},
		"Username of the remote server.": {"ru":"Имя пользователя удаленного сервера."},
		"Variable to save the result": {"ru":"Переменная, в которую сохранить результат"},
		"New remote path to file or folder": {"ru":"Новый удаленный путь к файлу или папке"},
		"Host (URL or IP) of the remote server.": {"ru":"Хост (URL или IP) удаленного сервера."},
		"Delete file/folder from remote server.": {"ru":"Удалить файл/папку с удаленного сервера."},
		"Default port for SFTP and SSH protocols": {"ru":"Порт по умолчанию для SFTP и SSH протоколов"},
		"This variable will contain the size of the file/folder.": {"ru":"Эта переменная будет содержать размер файла/папки."},
		"The path to the required file/folder on the remote server.": {"ru":"Путь до нужного файла/папки на удаленном сервере."},
		"Get information about a file located on a remote server.": {"ru":"Получить информацию о файле находящемся на удаленном сервере."},
		"Configure access to a remote server for working with files.": {"ru":"Настроить доступ к удаленному серверу для работы с файлами."},
		"The path on the remote server to the file/folder after moving.": {"ru":"Путь на удаленном сервере к файлу/папке после перемещения."},
		"Move the file/folder to another location on the remote server.": {"ru":"Переместить файл/папку в другое место на удаленном сервере."},
		"If a non-existent destination path is specified, it will be created.": {"ru":"Если указан несуществующий путь назначения, он будет создан."},
		"Upload the file/folder to the specified location on the remote server.": {"ru":"Загрузить файл/папку в указанное место на удаленном сервере."},
		"The path on the remote server to the file/folder which needs to be deleted.": {"ru":"Путь на удаленном сервере к файлу/папке который нужно удалить."},
		"This variable will contain the date the file/folder was last modified.": {"ru":"Эта переменная будет содержать дату последнего изменения файла/папки."},
		"The path on the remote server to the file/folder which needs to be moved.": {"ru":"Путь на удаленном сервере к файлу/папке который нужно переместить."},
		"The path to the file/folder which needs to be uploaded to the remote server.": {"ru":"Путь к файлу/папке который нужно загрузить на удаленный сервер."},
		"The path on the remote server to the file/folder which needs to be downloaded.": {"ru":"Путь на удаленном сервере к файлу/папке который нужно скачать."},
		"The protocol by which the connection to the remote server will be made.": {"ru":"Протокол по которому будет производится подключение к удаленному серверу."},
		"Check if a file/folder exists at the specified path on the remote server.": {"ru":"Проверить существует ли файл/папка по заданному пути на удаленном сервере."},
		"Download file/folder from a remote server and save to the specified location.": {"ru":"Скачать файл/папку с удаленного сервера и сохранить в указанное место."},
		"This action can be used to rename a file/folder on a remote server.": {"ru":"Данное действие можно использовать чтобы переименовать файл/папку на удаленном сервере."},
		"The path on the remote server to the file/folder about which needs to get information.": {"ru":"Путь на удаленном сервере к файлу/папке о котором нужно получить информацию."},
		"The path on the remote server to the file/folder whose existence needs to be checked.": {"ru":"Путь на удаленном сервере к файлу/папке существование которого нужно проверить."},
		"If uploaded files already exist along the destination path, they will be overwritten.": {"ru":"Если загруженные файлы уже существуют по пути назначения, они будут перезаписаны."},
		"This variable will contain the path to the directory where the file/folder is located.": {"ru":"Эта переменная будет содержать путь к директории в которой находится файл/папка."},
		"If downloaded files already exist along the destination path, they will be overwritten.": {"ru":"Если скачиваемые файлы уже существуют по пути назначения, они будут перезаписаны."},
		"This variable will be to true or false depending on the existence of the file/folder.": {"ru":"Эта переменная будет равна true или false в зависимости от существования файла/папки."},
		"The path to the location on the remote server where the uploaded file/folder will be saved.": {"ru":"Путь к месту на удаленном сервере в которое будет сохранен загруженный файл/папка."},
		"In order to execute this action correctly you need to run \"Configure FTP/SSH\" action first.": {"ru":"Для правильной работы необходимо сначала выполнить действие \"Настроить FTP/SSH\"."},
		"The path to the location where the file/folder downloaded from the remote server will be saved.": {"ru":"Путь к месту в которое будет сохранен файл/папка скачанный с удаленного сервера."},
		"This action should be called once before any other action that works with the remote server.": {"ru":"Это действие нужно вызвать один раз перед любым другим действием, которое работает с удаленным сервером."},
		"This variable will be true or false depending on whether the specified path leads to the file is or not.": {"ru":"Эта переменная будет равна true или false в зависимости от того ведет ли указанный путь к файлу или нет."},
		"This variable will be true or false depending on whether the specified path leads to the directory is or not.": {"ru":"Эта переменная будет равна true или false в зависимости от того ведет ли указанный путь к папке или нет."},
		"If a resource is specified in the \"Destination path\" parameter, instead of the content of the resource will indicate its location.": {"ru":"Если в параметре \"Путь назначения\" указан ресурс, вместо содержимого ресурса будет браться его расположение."},
		"If a resource is specified in the \"File or folder path\" parameter, instead of the content of the resource will indicate its location.": {"ru":"Если в параметре \"Путь к файлу или папке\" указан ресурс, вместо содержимого ресурса будет браться его расположение."},
		"If an error occurred while execute action, the thread will stop with fail message. If you want to continue thread, use \"Ignore errors\" action.":{"ru":"Если во время выполнения действия произойдет ошибка, поток остановится с сообщением об ошибке. Если вы хотите продолжить работу, используйте действие \"Игнорировать ошибки\"."}
    },
    "major_version": 1,
    "minor_version": 0,
    "modules": [
        {
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0",
            "ModuleName": "ftp",
            "ModuleVersion": "*"
        },
        {
            "LanguageName": "Node",
            "LanguageVersion": "8.6.0",
            "ModuleName": "ssh2-sftp-client",
            "ModuleVersion": "*"
        }
    ],
    "name": "FTP"
}